<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Enhanced McDonald's Receipt Generator</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #ff6b35, #f7931e);
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .header {
      background: #ffcc02;
      padding: 30px;
      text-align: center;
    }
    .header h1 {
      color: #d63031;
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .header p {
      color: #2d3436;
      font-size: 1.1em;
    }
    .main-content {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      padding: 30px;
    }
    .form-section {
      flex: 1;
      min-width: 300px;
      background: #f8f9fa;
      padding: 30px;
      border-radius: 15px;
      border: 2px solid #e9ecef;
    }
    .form-section h2 {
      color: #2d3436;
      margin-bottom: 20px;
      font-size: 1.5em;
      border-bottom: 2px solid #ffcc02;
      padding-bottom: 10px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #2d3436;
      font-weight: bold;
    }
    .form-group input, .form-group select, .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s;
    }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
      outline: none;
      border-color: #ff6b35;
    }
    .items-section {
      border: 2px dashed #ddd;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
    }
    .item-row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      align-items: center;
    }
    .item-row input[type="text"] { flex: 2; }
    .item-row input[type="number"] { flex: 1; }
    .remove-item-btn, .remove-discount-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 12px;
      width: 30px;
      height: 30px;
    }
    .add-item-btn, .add-discount-btn {
      background: #27ae60;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 10px;
    }
    .receipt-section {
      flex: 1;
      min-width: 350px;
      max-width: 400px;
    }
    .receipt {
      background: white;
      border: 1px solid #ccc;
      padding: 20px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      line-height: 1.5;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      position: sticky;
      top: 20px;
      width: 350px;
      margin: 0 auto;
      transition: all 0.3s ease;
    }
    .receipt-header-image {
      text-align: center;
      margin-bottom: 15px;
    }
    .receipt-header-image img {
      max-width: 80%;
      height: auto;
      transition: all 0.3s ease;
    }
    .receipt-header { text-align: center; margin-bottom: 10px; }
    .receipt-pickup-code {
      font-size: 2.5em;
      font-weight: bold;
      text-align: center;
      margin: 10px 0;
    }
    .receipt-separator {
      border-top: 1px dashed #333;
      margin: 10px 0;
    }
    .receipt-item {
      display: flex;
      justify-content: space-between;
    }
    .receipt-total {
      font-weight: bold;
    }
    .receipt-footer {
      text-align: center;
      margin-top: 15px;
    }
    .download-btn {
      background: #007bff;
      color: white;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      width: 100%;
      margin-top: 15px;
      border: none;
    }
    .delivery-row {
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding: 15px;
      border: 2px dashed #ddd;
      border-radius: 10px;
      background-color: #f1f1f1;
      margin-top: 10px;
    }
    .delivery-row label {
      font-weight: bold;
    }
    .delivery-row input {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    .remove-delivery-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      width: fit-content;
      font-size: 12px;
    }

    /* Theme-based styling */
    .receipt.theme-puppy {
      background: linear-gradient(135deg, #fff9e6, #ffe6cc);
      border: 2px solid #ff9900;
    }
    
    .receipt.theme-christmas {
      background: linear-gradient(135deg, #f0fff0, #e6ffe6);
      border: 2px solid #228b22;
    }
    
    .receipt.theme-valentine {
      background: linear-gradient(135deg, #ffe6f0, #ffd6e6);
      border: 2px solid #ff1493;
    }
    
    .receipt.theme-halloween {
      background: linear-gradient(135deg, #fff5e6, #ffe6cc);
      border: 2px solid #ff6600;
    }

    @media (max-width: 768px) {
      .main-content {
        flex-direction: column;
      }
      .form-section, .receipt-section {
        max-width: 100%;
        width: 100%;
      }
      .receipt {
        position: relative;
        top: 0;
        margin-top: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üçü Enhanced Receipt Generator</h1>
      <p>Create highly customized, realistic receipts for any occasion</p>
    </div>

    <div class="main-content">
      <div class="form-section">
        <h2>üìù Customize Your Receipt</h2>
        <div class="form-group">
          <label for="storeName">Store Name:</label>
          <input type="text" id="storeName" value="McDonald's">
        </div>
        <div class="form-group">
          <label for="storeCode">Store Code:</label>
          <input type="text" id="storeCode" value="1234">
        </div>
        <div class="form-group">
          <label for="storeAddress">Store Address:</label>
          <input type="text" id="storeAddress" value="10207 Lakewood Blvd, Downey">
        </div>
        <div class="form-group">
          <label for="pickupCode">Pickup Code:</label>
          <input type="text" id="pickupCode">
        </div>
        <div class="form-group">
          <label for="orderNumber">Order Number:</label>
          <input type="text" id="orderNumber">
        </div>
        <div class="form-group">
          <label for="cashierName">Cashier Name:</label>
          <input type="text" id="cashierName" value="Ronald McDonald">
        </div>
        <div class="form-group">
          <label for="dateTime">Date & Time:</label>
          <input type="text" id="dateTime">
        </div>
        <div class="form-group">
          <label for="theme">Theme:</label>
          <select id="theme">
            <option value="none">None (Original)</option>
            <option value="puppy">üê∂ Happy Puppy</option>
            <option value="christmas">üéÑ Christmas Special</option>
            <option value="valentine">üíù Valentine's Day</option>
            <option value="halloween">üéÉ Halloween</option>
            <option value="birthday">üéÇ Birthday</option>
            <option value="summer">‚òÄÔ∏è Summer Fun</option>
          </select>
        </div>
        <div class="form-group">
          <label for="note">Note (Optional):</label>
          <textarea id="note" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label for="customImage">Upload Image (Optional):</label>
          <input type="file" id="customImage" accept="image/*">
        </div>
        <div id="imageActionButtons" style="display: none; margin-top: 10px;">
            <button type="button" onclick="cancelImage()" style="margin-right: 10px;">‚ùå Cancel</button>
            <button type="button" onclick="redoImage()">üîÅ Redo</button>
        </div>
        <div class="items-section">
          <h3>üçî Menu Items</h3>
          <div id="itemsContainer"></div>
          <button class="add-item-btn" onclick="addItem()">+ Add Item</button>
        </div>
        <div class="items-section">
          <h3>üí∏ Discounts</h3>
          <div id="discountsContainer"></div>
          <button class="add-discount-btn" onclick="addDiscount()">+ Add Discount</button>
        </div>
        <div class="items-section">
          <h3>üì¶ Delivery Info</h3>
          <div id="deliveryContainer"></div>
          <button class="add-discount-btn" onclick="addDelivery()">+ Add Recipient</button>
        </div>
      </div>

      <div class="receipt-section">
        <div class="receipt" id="receiptPreview">
          <div class="receipt-header-image">
            <img src="./src/mc_logo.png" alt="McDonald's Logo" id="themeImage" />
          </div>
          <div class="receipt-header">
            <div id="receiptStoreName" style="font-weight: bold;">McDonald's</div>
            <div id="receiptStoreCode"></div>
            <div id="receiptStoreAddress"></div>
          </div>
          <div class="receipt-pickup-code" id="receiptPickupCode"></div>
          <div>Cashier: <span id="receiptCashierName"></span></div>
          <div>Date: <span id="receiptDateTime"></span></div>
          <div>Order Number: <span id="receiptOrderNumber"></span></div>
          <div class="receipt-separator"></div>
          <div id="receiptItems"></div>
          <div id="receiptDiscounts"></div>
          <div class="receipt-separator"></div>
          <div class="receipt-total">
            <div class="receipt-item"><span>Subtotal:</span><span id="subtotal">$0.00</span></div>
            <div class="receipt-item"><span>Tax:</span><span id="taxAmount">$0.00</span></div>
            <div class="receipt-item"><span>Total:</span><span id="total">$0.00</span></div>
          </div>
          <div id="receiptDeliverySection"></div>
          <div id="customImagePreview"></div>
          <div class="receipt-separator"></div>
          <div class="receipt-footer">
            <div id="receiptNote"></div>
            <div id="themeMessage">Thank you for your order!</div>
          </div>
        </div>
        <button class="download-btn" onclick="downloadReceipt()">üíæ Download Receipt as PNG</button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    let customImageData = '';
    let customImageVisible = true;

    // Theme configuration
    const themes = {
      none: {
        image: './src/mc_logo.png',
        alt: "McDonald's Logo",
        className: '',
        message: 'Thank you for your order!'
      },
      puppy: {
        image: './src/mc_puppy.png',
        alt: "Happy Puppy McDonald's",
        className: 'theme-puppy',
        message: 'Have a paw-some day! üê∂'
      },
      christmas: {
        image: './src/mc_christmas.png',
        alt: "Christmas McDonald's",
        className: 'theme-christmas',
        message: 'Merry Christmas and Happy Holidays! üéÑ'
      },
      valentine: {
        image: './src/mc_valentine.png',
        alt: "Valentine's McDonald's",
        className: 'theme-valentine',
        message: 'Made with love! Happy Valentine\'s Day! üíù'
      },
      halloween: {
        image: './src/mc_halloween.png',
        alt: "Halloween McDonald's",
        className: 'theme-halloween',
        message: 'Have a spook-tacular day! üéÉ'
      },
      birthday: {
        image: './src/mc_birthday.png',
        alt: "Birthday McDonald's",
        className: 'theme-birthday',
        message: 'Happy Birthday! Make it a special day! üéÇ'
      },
      summer: {
        image: './src/mc_summer.png',
        alt: "Summer McDonald's",
        className: 'theme-summer',
        message: 'Enjoy your summer treats! ‚òÄÔ∏è'
      }
    };

    function initialize() {
      const now = new Date();
      document.getElementById('pickupCode').value = Math.floor(1000 + Math.random() * 9000);
      document.getElementById('orderNumber').value = Date.now();
      document.getElementById('dateTime').value = now.toISOString().slice(0, 16).replace('T', ' ');
      document.getElementById('theme').addEventListener('change', updateTheme);

      addItem('Big Mac', 1, 5.99);
      addItem('Fries', 1, 2.99);
      addItem('Coke', 1, 1.99);
      generateReceipt();
      updateTheme();
    }

    document.addEventListener('DOMContentLoaded', () => {
      initialize();

      document.getElementById('customImage').addEventListener('change', function () {
        const file = this.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function (e) {
            customImageData = e.target.result;
            customImageVisible = true;
            document.getElementById('imageActionButtons').style.display = 'block';
            generateReceipt();
          };
          reader.readAsDataURL(file);
        } else {
          customImageData = '';
          customImageVisible = false;
          document.getElementById('imageActionButtons').style.display = 'none';
          generateReceipt();
        }
      });

      document.querySelector('.form-section').addEventListener('input', generateReceipt);
    });

    function updateTheme() {
      const themeSelect = document.getElementById('theme');
      const selectedTheme = themeSelect.value;
      const themeConfig = themes[selectedTheme] || themes.none;
      
      // Update image
      const imageElement = document.getElementById('themeImage');
      imageElement.src = themeConfig.image;
      imageElement.alt = themeConfig.alt;
      
      // Update receipt styling
      const receiptElement = document.getElementById('receiptPreview');
      
      // Remove all theme classes
      Object.values(themes).forEach(theme => {
        if (theme.className) {
          receiptElement.classList.remove(theme.className);
        }
      });
      
      // Add current theme class
      if (themeConfig.className) {
        receiptElement.classList.add(themeConfig.className);
      }
      
      // Update theme message
      document.getElementById('themeMessage').textContent = themeConfig.message;
      
      // Handle image load error (fallback to default)
      imageElement.onerror = function() {
        console.warn(`Theme image not found: ${themeConfig.image}, falling back to default`);
        this.src = './src/mc_logo.png';
        this.alt = "McDonald's Logo";
      };
    }

    function addItem(name = '', qty = 1, price = 0.00) {
      const row = document.createElement('div');
      row.className = 'item-row';
      row.innerHTML = `
        <input type="text" value="${name}" placeholder="Item Name">
        <input type="number" value="${qty}" min="1">
        <input type="number" value="${price}" step="0.01" min="0">
        <button class="remove-item-btn" onclick="this.parentElement.remove(); generateReceipt()">‚úï</button>
      `;
      document.getElementById('itemsContainer').appendChild(row);
      generateReceipt();
    }

    function addDiscount(name = 'Discount', amount = 1.00) {
      const row = document.createElement('div');
      row.className = 'item-row';
      row.innerHTML = `
        <input type="text" value="${name}">
        <input type="number" value="${amount}" step="0.01" min="0">
        <button class="remove-discount-btn" onclick="this.parentElement.remove(); generateReceipt()">‚úï</button>
      `;
      document.getElementById('discountsContainer').appendChild(row);
      generateReceipt();
    }

    function addDelivery() {
      const container = document.getElementById('deliveryContainer');
      const addBtn = document.querySelector('.add-discount-btn[onclick="addDelivery()"]');
      if (container.children.length > 0) return;
      container.innerHTML = `
        <div class="delivery-row">
          <label for="deliveryName">Name:</label>
          <input type="text" id="deliveryName" placeholder="John Doe">
          <label for="deliveryAddress">Address:</label>
          <input type="text" id="deliveryAddress" placeholder="123 Main St">
          <label for="deliveryPhone">Phone:</label>
          <input type="text" id="deliveryPhone" placeholder="555-123-4567">
          <button class="remove-delivery-btn" onclick="removeDelivery()">‚úï Remove</button>
        </div>
      `;
      if (addBtn) addBtn.style.display = 'none';
      generateReceipt();
    }

    function removeDelivery() {
      document.getElementById('deliveryContainer').innerHTML = '';
      document.querySelector('.add-discount-btn[onclick="addDelivery()"]').style.display = 'inline-block';
      generateReceipt();
    }

    function generateReceipt() {
      const storeName = document.getElementById('storeName').value;
      const storeCode = document.getElementById('storeCode').value;
      const storeAddress = document.getElementById('storeAddress').value;
      const pickupCode = document.getElementById('pickupCode').value;
      const orderNumber = document.getElementById('orderNumber').value;
      const cashier = document.getElementById('cashierName').value;
      const dateTime = document.getElementById('dateTime').value;
      const note = document.getElementById('note').value;

      document.getElementById('receiptStoreName').textContent = storeName;
      document.getElementById('receiptStoreCode').textContent = `Restaurant #${storeCode}`;
      document.getElementById('receiptStoreAddress').textContent = storeAddress;
      document.getElementById('receiptPickupCode').textContent = pickupCode;
      document.getElementById('receiptOrderNumber').textContent = orderNumber;
      document.getElementById('receiptCashierName').textContent = cashier;
      document.getElementById('receiptDateTime').textContent = dateTime;
      document.getElementById('receiptNote').textContent = note;

      let subtotal = 0;
      const items = document.querySelectorAll('#itemsContainer .item-row');
      const itemHtml = Array.from(items).map(row => {
        const inputs = row.querySelectorAll('input');
        const name = inputs[0].value;
        const qty = parseInt(inputs[1].value);
        const price = parseFloat(inputs[2].value);
        const total = qty * price;
        subtotal += total;
        return `<div class="receipt-item"><span>${qty} ${name}</span><span>$${total.toFixed(2)}</span></div>`;
      }).join('');
      document.getElementById('receiptItems').innerHTML = itemHtml;

      const discounts = document.querySelectorAll('#discountsContainer .item-row');
      let totalDiscount = 0;
      const discountHtml = Array.from(discounts).map(row => {
        const name = row.querySelectorAll('input')[0].value;
        const amount = parseFloat(row.querySelectorAll('input')[1].value);
        totalDiscount += amount;
        return `<div class="receipt-item"><span>- ${name}</span><span>-$${amount.toFixed(2)}</span></div>`;
      }).join('');
      document.getElementById('receiptDiscounts').innerHTML = discountHtml;

      const tax = subtotal * 0.0825;
      const total = subtotal - totalDiscount + tax;

      document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
      document.getElementById('taxAmount').textContent = `$${tax.toFixed(2)}`;
      document.getElementById('total').textContent = `$${total.toFixed(2)}`;

      const deliverySection = document.getElementById('receiptDeliverySection');
      const name = document.getElementById('deliveryName');
      if (name) {
        deliverySection.innerHTML = `<div class="receipt-separator"></div>
          <div style="font-weight: bold;">Delivery To:</div>
          <div>${name.value}</div>
          <div>${document.getElementById('deliveryAddress').value}</div>
          <div>${document.getElementById('deliveryPhone').value}</div>`;
      } else {
        deliverySection.innerHTML = '';
      }

      const customImage = document.getElementById('customImagePreview');
      if (customImageData && customImageVisible) {
        customImage.innerHTML = `<div style="text-align:center;margin:10px 0;">
          <img src="${customImageData}" alt="Custom Image" style="max-width:100%;height:auto;">
        </div>`;
      } else {
        customImage.innerHTML = '';
      }
    }

    function downloadReceipt() {
      const receiptElement = document.getElementById('receiptPreview');
      html2canvas(receiptElement, { scale: 2 }).then(canvas => {
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = 'custom-receipt.png';
        link.click();
      });
    }

    function cancelImage() {
      customImageVisible = false;
      generateReceipt();
    }

    function redoImage() {
      if (customImageData) {
        customImageVisible = true;
        generateReceipt();
      }
    }
  </script>
</body>
</html>